<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Target Privacy Threat Model</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) and (display:contents) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version e1a165f1c2fb1cc2aceb87e110984a42830c36fa" name="generator">
  <link href="http://jyasskin.github.io/privacy-threat-model" rel="canonical">
  <meta content="8308315f9d2c7043e8d19fd71bc15624941501db" name="document-revision">
<style>
.threatmodel tr.goals th {
  padding: 1ex;
  max-height: 20em;
}
.threatmodel tr.goals th * {
  writing-mode: vertical-rl;
}
.threatmodel td {
  text-align: center;
}
details[open] {
  position: absolute;
  background: white;
  border: thin black solid;
  text-align: left;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Target Privacy Threat Model</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="2019-12-02">2 December 2019</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://jyasskin.github.io/privacy-threat-model">http://jyasskin.github.io/privacy-threat-model</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/jyasskin/privacy-threat-model/issues/">GitHub</a>
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="72192"><a class="p-name fn u-email email" href="mailto:jyasskin@google.com">Jeffrey Yasskin</a> (<a class="p-org org" href="https://google.com/">Google Inc.</a>)
    </dl>
   </div>
   <div data-fill-with="warning">
    <details class="annoying-warning" open>
     <summary>Not Ready For Implementation</summary>
     <p> This spec is not yet ready for implementation.
		It exists in this repository to record the ideas and promote discussion. </p>
     <p> Before attempting to implement this spec,
		please contact the editors. </p>
    </details>
   </div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="https://licensebuttons.net/p/zero/1.0/80x15.png"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 2 December 2019,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>A privacy threat model we should migrate the web toward.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#terminology"><span class="secno">2</span> <span class="content">Terminology</span></a>
    <li><a href="#high-level-threats"><span class="secno">3</span> <span class="content">High-level threats</span></a>
    <li>
     <a href="#model"><span class="secno">4</span> <span class="content">Threat Model</span></a>
     <ol class="toc">
      <li><a href="#model-anti-tracking"><span class="secno">4.1</span> <span class="content">Anti-tracking</span></a>
     </ol>
    <li>
     <a href="#capabilities"><span class="secno">5</span> <span class="content">Attacker Capabilities</span></a>
     <ol class="toc">
      <li><a href="#cap-iframes"><span class="secno">5.1</span> <span class="content">Load iframes</span></a>
      <li><a href="#cap-first-party-js"><span class="secno">5.2</span> <span class="content">Run Javascript in a first-party context</span></a>
      <li><a href="#cap-run-on-server"><span class="secno">5.3</span> <span class="content">Modify server processing</span></a>
      <li><a href="#cap-read-logs"><span class="secno">5.4</span> <span class="content">Read server logs</span></a>
     </ol>
    <li>
     <a href="#goals"><span class="secno">6</span> <span class="content">Attacker goals</span></a>
     <ol class="toc">
      <li>
       <a href="#goals-metrics"><span class="secno">6.1</span> <span class="content">User metrics within a single site</span></a>
       <ol class="toc">
        <li><a href="#goal-click-tracking"><span class="secno">6.1.1</span> <span class="content">Click tracking</span></a>
       </ol>
      <li>
       <a href="#goals-tracking"><span class="secno">6.2</span> <span class="content">Tracking</span></a>
       <ol class="toc">
        <li><a href="#goal-transfer-userid"><span class="secno">6.2.1</span> <span class="content">Transfer user ID from publisher 1 to publisher 2 on navigation.</span></a>
        <li><a href="#goal-userid-tracker-to-self-in-pub"><span class="secno">6.2.2</span> <span class="content">Transfer user ID from tracker to that tracker running within a publisher, on navigation.</span></a>
        <li><a href="#goal-userid-tracker-in-pub1-to-self-in-pub2"><span class="secno">6.2.3</span> <span class="content">Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</span></a>
        <li><a href="#goal-prob-transfer-userid"><span class="secno">6.2.4</span> <span class="content">Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</span></a>
        <li><a href="#goal-prob-transfer-userid-no-nav"><span class="secno">6.2.5</span> <span class="content">Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</span></a>
       </ol>
     </ol>
    <li>
     <a href="#essential"><span class="secno">7</span> <span class="content">Essential Web APIs</span></a>
     <ol class="toc">
      <li><a href="#ess-js-requests"><span class="secno">7.1</span> <span class="content">Javascript can make requests to servers</span></a>
      <li><a href="#ess-server-defined-paths"><span class="secno">7.2</span> <span class="content">Servers can define the paths under which they host content</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">8</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p><strong class="advisement"> This document is at a very early stage. Many things in it are wrong
and/or incomplete. Please take it as a rough shape for how we might document the
target threat model, rather than as definite statements about what should be in
the target threat model.</strong></p>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>As a <strong>threat model</strong>, this specification describes attacker capabilities and
attacker goals, and says which goals which capabilities should and should not
enable.</p>
   <p>As a <strong>privacy</strong> threat model, the attacker goals compromise the privacy of
users, rather than their security.</p>
   <p>As a <strong>target</strong> threat model, it describes not the current state of the Web
including all current maybe-unwise APIs, but rather an end state that we hope to
migrate to, and that new APIs should be held to. This is meant to be a <em>plausible</em> threat model: it doesn’t expect to remove any APIs or browser
behavior that is deemed essential to the viability of the Web.</p>
   <p>Since people are likely to disagree about which APIs are essential to the Web,
when saying that an attacker can achieve their goal, this document describes how
the attacker achieves it using particular "essential" APIs, and it provides an
index of those APIs so readers can point out ones that they don’t consider
essential.</p>
   <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <p><a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin">origin</a> as the tuple of a scheme, hostname, and port that
provides the main security boundary on the web.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="site">site</dfn> is the set of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin①">origins</a> whose hostnames share a common <a data-link-type="dfn" href="https://publicsuffix.org/list/#list-format" id="ref-for-list-format">registrable domain</a>. Note that there are problems (<a data-link-type="biblio" href="#biblio-psl-problems">[PSL-PROBLEMS]</a>) with
using <a data-link-type="dfn" href="https://publicsuffix.org/list/#list-format" id="ref-for-list-format①">registrable domains</a> as a logical boundary.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="party">party</dfn> is defined by <a data-link-type="biblio" href="#biblio-tracking-dnt">[tracking-dnt]</a> as "a natural person, a legal
entity, or a set of legal entities that share common owner(s), common
controller(s), and a group identity that is easily discoverable by a user."</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="first-party">first party</dfn> for a user action is the <a data-link-type="dfn" href="#party" id="ref-for-party">party</a> that controls the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin" id="ref-for-concept-origin②">origin</a> of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a> under which the action
happened. Intuitively, this is the owner of the domain in the browser’s URL bar.
This differs from <a href="https://wiki.mozilla.org/Security/Anti_tracking_policy#Tracking_Definition">Mozilla’s
definition</a> in that Mozilla defines other parties as first parties if the
user can easily discover which party it is and intends to interact with that
party, for example to allow sign-in widgets to be first-party.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="third-party">third party</dfn> for a user action is any party that isn’t the <a data-link-type="dfn" href="#first-party" id="ref-for-first-party">first
party</a> or the user (the second party).</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="user">user</dfn> is a human or program that controls a user agent.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="user-id">user ID</dfn> is a pair of a <a data-link-type="dfn" href="#site" id="ref-for-site">site</a> and a (potentially-large) integer
allocated by that site that is used to identify a <a data-link-type="dfn" href="#user" id="ref-for-user">user</a> on that site. A
single user will generally have many user IDs that refer to them, and a single
site may or may not know that multiple user IDs refer to the same user.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="global-identifier">global identifier</dfn> is a string that identifies a particular <a data-link-type="dfn" href="#user" id="ref-for-user①">user</a> independent of which site they’re visiting. Users generally have relatively few
global identifiers and can usually list and recognize them. A goal of
anti-tracking policy is to prevent <a data-link-type="dfn" href="#user-id" id="ref-for-user-id">user IDs</a> from becoming <a data-link-type="dfn" href="#global-identifier" id="ref-for-global-identifier">global
identifiers</a>.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="attacker">attacker</dfn> is any entity trying to get information that a <a data-link-type="dfn" href="#user" id="ref-for-user②">user</a> might not want them to get. Attackers are often entities that a user intends to
interact with in other ways, as both <a data-link-type="dfn" href="#first-party" id="ref-for-first-party①">first</a> and <a data-link-type="dfn" href="#third-party" id="ref-for-third-party">third parties</a>, and some users may
not mind their collection of this information.</p>
   <p>This document uses the terms <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="publisher">publisher</dfn> and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="tracker">tracker</dfn> colloquially to refer to particular kinds of <a data-link-type="dfn" href="#site" id="ref-for-site①">sites</a> and the <a data-link-type="dfn" href="#party" id="ref-for-party①">parties</a> that
operate them. They are not rigorously defined.</p>
   <h2 class="heading settled" data-level="3" id="high-level-threats"><span class="secno">3. </span><span class="content">High-level threats</span><a class="self-link" href="#high-level-threats"></a></h2>
   <p>User agents should attempt to defend their users from a variety of high-level threats or attacker goals, described in this section. <a href="#goals">§ 6 Attacker goals</a> then describes the low-level steps an attacker would use to achieve these high-level goals.</p>
   <p class="issue" id="issue-05a52c93"><a class="self-link" href="#issue-05a52c93"></a> This section is not complete. It lists a lot of potential privacy
threats, but needs editing to pick which kinds of threats belong in this threat
model and to unify the multiple lists of suggestions.</p>
   <p>The following threats were brainstormed in the 2019 TPAC PING meeting:</p>
   <ul>
    <li data-md>
     <p>Unexpected Recognition (being confident that this is the same person/device
you saw before), cross-site. This threat is discussed in <a href="#model-anti-tracking">§ 4.1 Anti-tracking</a>.</p>
    <li data-md>
     <p>Recognition, same-site</p>
    <li data-md>
     <p>Benign information disclosure (connected hardware [game controller or
assistive device], system preferences [like dark mode]…)</p>
    <li data-md>
     <p>Sensitive information disclosure (user location, user camera, file
information, financial data, contacts, calendar…)</p>
    <li data-md>
     <p>Intrusion (displaying messages/notifications, playing sounds, full screen…)</p>
    <li data-md>
     <p>Obtaining capabilities (sending SMS, finance/billing…)</p>
   </ul>
   <p>The following threats are copied from <a href="https://www.w3.org/TR/security-privacy-questionnaire/#threats">Self-Review Questionnaire: Security and Privacy §threats</a>. They are not all addressed in this
document.</p>
   <dl>
    <dt data-md>Surveillance
    <dd data-md>
     <p>Surveillance is the observation or monitoring of an individual’s
communications or activities.</p>
    <dt data-md>Stored Data Compromise
    <dd data-md>
     <p>End systems that do not take adequate measures to secure stored data from
unauthorized or inappropriate access.</p>
    <dt data-md>Intrusion
    <dd data-md>
     <p>Intrusion consists of invasive acts that disturb or interrupt one’s life or
activities.</p>
    <dt data-md>Misattribution
   </dl>
   <p>::: Misattribution occurs when data or communications related to one individual
    are attributed to another.</p>
   <dl>
    <dt data-md>Correlation
    <dd data-md>
     <p>Correlation is the combination of various pieces of information related to an
individual or that obtain that characteristic when combined.</p>
    <dt data-md>Identification
    <dd data-md>
     <p>Identification is the linking of information to a particular individual to
infer an individual’s identity or to allow the inference of an individual’s
identity.</p>
    <dt data-md>Secondary Use
    <dd data-md>
     <p>Secondary use is the use of collected information about an individual without
the individual’s consent for a purpose different from that for which the
information was collected.</p>
    <dt data-md>Disclosure
    <dd data-md>
     <p>Disclosure is the revelation of information about an individual that affects
the way others judge the individual.</p>
    <dt data-md>Exclusion
    <dd data-md>
     <p>Exclusion is the failure to allow individuals to know about the data that
others have about them and to participate in its handling and use.</p>
   </dl>
   <h2 class="heading settled" data-level="4" id="model"><span class="secno">4. </span><span class="content">Threat Model</span><a class="self-link" href="#model"></a></h2>
   <p>This table summarizes which capabilities should allow attackers to achieve which
goals and, conversely, which goals should be frustrated for attackers even when
they have certain capabilities.</p>
   <p><span style="color:green">✘</span> indicates that the goal should be frustrated,
while <span style="color:red">✓</span> indicates that the attacker can achieve
their goal.</p>
   <p class="issue" id="issue-eb037c92"><a class="self-link" href="#issue-eb037c92"></a> Should we mark goals attackers can currently achieve, which we want to
remove, differently from goals attackers already can’t achieve?</p>
   <h3 class="heading settled" data-level="4.1" id="model-anti-tracking"><span class="secno">4.1. </span><span class="content">Anti-tracking</span><a class="self-link" href="#model-anti-tracking"></a></h3>
    TODO 
   <table class="threatmodel">
    <tbody>
     <tr class="goals">
      <td>
      <th><a href="#goal-transfer-userid">§ 6.2.1 Transfer user ID from publisher 1 to publisher 2 on navigation.</a>
      <th><a href="#goal-userid-tracker-to-self-in-pub">§ 6.2.2 Transfer user ID from tracker to that tracker running within a publisher, on navigation.</a>
      <th><a href="#goal-userid-tracker-in-pub1-to-self-in-pub2">§ 6.2.3 Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</a>
      <th><a href="#goal-prob-transfer-userid-no-nav">§ 6.2.5 Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</a>
      <th><a href="#goal-prob-transfer-userid">§ 6.2.4 Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</a>
     <tr>
      <th><a href="#cap-iframes">§ 5.1 Load iframes</a>
      <td data-goal="transfer-userid" style="color:green">✘
      <td data-goal="userid-tracker-to-self-in-pub" style="color:green">✘
      <td data-goal="userid-tracker-in-pub1-to-self-in-pub2" style="color:green">✘
      <td data-goal="prob-transfer-userid-no-nav" style="color:green">✘
      <td data-goal="prob-transfer-userid" style="color:green">✘
     <tr>
      <th><a href="#cap-first-party-js">§ 5.2 Run Javascript in a first-party context</a>
      <td data-goal="transfer-userid" style="color:green">✘
      <td data-goal="userid-tracker-to-self-in-pub" style="color:green">✘
      <td data-goal="userid-tracker-in-pub1-to-self-in-pub2" style="color:green">✘
      <td data-goal="prob-transfer-userid-no-nav" style="color:green">✘
      <td data-goal="prob-transfer-userid" style="color:green">✘
     <tr>
      <th><a href="#cap-read-logs">§ 5.4 Read server logs</a> on other publishers
      <td data-goal="transfer-userid" style="color:green">✘
      <td data-goal="userid-tracker-to-self-in-pub" style="color:green">✘
      <td data-goal="userid-tracker-in-pub1-to-self-in-pub2" style="color:green">✘
      <td data-goal="prob-transfer-userid-no-nav" style="color:green">✘
      <td data-goal="prob-transfer-userid">
       <details>
        <summary style="color:red">✓</summary>
         Publisher 2 reads their own logs for the page load and publisher 1’s logs for the click tracking of the navigation click. <a data-link-type="dfn" href="#user-id" id="ref-for-user-id①">User IDs</a> that clicked on publisher 1 approximately the same
    time as that link’s target loaded on publisher 2 are
    probabilistically correlated. 
       </details>
     <tr>
      <th><a href="#cap-run-on-server">§ 5.3 Modify server processing</a> on the target publisher
      <td data-goal="transfer-userid"> <span style="color:green">✘</span> 
      <td data-goal="userid-tracker-to-self-in-pub">
       <details>
        <summary style="color:red">✓</summary>
         The tracker adds a path segment, possibly encrypted, in their links to the
    publisher, encoding the user’s ID within the tracker. They convince the
    publisher to <a href="#ess-server-defined-paths">ignore that path segment in
    their server processing</a>. The tracker running inside that publisher reads
    the URL, decodes the tracker site’s user ID, and <a href="#ess-js-requests">sends that and the tracker-within-publisher user ID
    up to the tracker’s server</a>. 
       </details>
      <td data-goal="userid-tracker-in-pub1-to-self-in-pub2"> <span style="color:green">✘</span> 
      <td data-goal="prob-transfer-userid-no-nav"> <span style="color:green">✘</span> 
      <td data-goal="prob-transfer-userid"> <span style="color:green">✘</span> 
     <tr>
      <th><a href="#cap-first-party-js">§ 5.2 Run Javascript in a first-party context</a> or <a href="#cap-run-on-server">§ 5.3 Modify server processing</a> on the source site and <a href="#cap-run-on-server">§ 5.3 Modify server processing</a> on the target publisher
      <td data-goal="transfer-userid"> <span style="color:green">✘</span> 
      <td data-goal="userid-tracker-to-self-in-pub">
       <details>
        <summary style="color:red">✓</summary>
         The tracker adds a path segment, possibly encrypted, in their links to the
      publisher, encoding the user’s ID within the tracker. They convince the
      publisher to <a href="#ess-server-defined-paths">ignore that path segment in
      their server processing</a>. The tracker running inside that publisher reads
      the URL, decodes the tracker site’s user ID, and <a href="#ess-js-requests">sends that and the tracker-within-publisher user ID
      up to the tracker’s server</a>. 
       </details>
      <td data-goal="userid-tracker-in-pub1-to-self-in-pub2">
       <details>
        <summary style="color:red">✓</summary>
         The tracker adds a path segment, possibly encrypted, in the publisher 1’s
      links to publisher 2, encoding the user’s ID within publisher 1. They
      convince publisher 2 to <a href="#ess-server-defined-paths">ignore that
      path segment in their server processing</a>. The tracker running inside
      that publisher reads the URL, decodes publisher 1’s user ID, and <a href="#ess-js-requests">sends that and publisher 2’s user ID up to the
      tracker’s server</a>. 
       </details>
      <td data-goal="prob-transfer-userid-no-nav"> <span style="color:red">✓</span> 
      <td data-goal="prob-transfer-userid"> <span style="color:red">✓</span> 
   </table>
   <h2 class="heading settled" data-level="5" id="capabilities"><span class="secno">5. </span><span class="content">Attacker Capabilities</span><a class="self-link" href="#capabilities"></a></h2>
   <p>These are things some attackers can do. The attackers can use them to achieve
their <a href="#goals">goals</a>. All attackers are assumed to be able to buy
domains and host sites on their domains.</p>
   <h3 class="heading settled" data-level="5.1" id="cap-iframes"><span class="secno">5.1. </span><span class="content">Load iframes</span><a class="self-link" href="#cap-iframes"></a></h3>
   <p>The attacker can convince a publisher to load an iframe from the attacker’s site.</p>
   <h3 class="heading settled" data-level="5.2" id="cap-first-party-js"><span class="secno">5.2. </span><span class="content">Run Javascript in a first-party context</span><a class="self-link" href="#cap-first-party-js"></a></h3>
   <p>When a publisher wants to show ads from an ad network, many/most ad networks
require that publisher to use a <code>&lt;script src="adnetwork.js"></code> tag instead of an <code>&lt;iframe src="adnetwork.html"></code>, which allows the ad network to see any
publisher data that’s exposed to Javascript. This includes query parameters
(e.g. <code>fbclid</code>) and any cookies that aren’t <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc6265#section-4.1.2.6" id="ref-for-section-4.1.2.6">HttpOnly</a>.</p>
   <h3 class="heading settled" data-level="5.3" id="cap-run-on-server"><span class="secno">5.3. </span><span class="content">Modify server processing</span><a class="self-link" href="#cap-run-on-server"></a></h3>
   <p>Some attackers can convince some publishers (perhaps by paying them) to modify
their server software. This could be used, for example, to receive <a data-link-type="dfn" href="#user-id" id="ref-for-user-id②">user IDs</a> passed in a path segment instead of a query parameter, without breaking the
normal logic mapping a path to content.</p>
   <h3 class="heading settled" data-level="5.4" id="cap-read-logs"><span class="secno">5.4. </span><span class="content">Read server logs</span><a class="self-link" href="#cap-read-logs"></a></h3>
   <p>Servers can keep logs of requests. The attacker may be able to convince some
server operators to give them these logs or let them run queries over the logs.</p>
   <h2 class="heading settled" data-level="6" id="goals"><span class="secno">6. </span><span class="content">Attacker goals</span><a class="self-link" href="#goals"></a></h2>
   <p>These are things <a data-link-type="dfn" href="#attacker" id="ref-for-attacker">attackers</a> want to accomplish.</p>
   <h3 class="heading settled" data-level="6.1" id="goals-metrics"><span class="secno">6.1. </span><span class="content">User metrics within a single site</span><a class="self-link" href="#goals-metrics"></a></h3>
   <h4 class="heading settled" data-level="6.1.1" id="goal-click-tracking"><span class="secno">6.1.1. </span><span class="content">Click tracking</span><a class="self-link" href="#goal-click-tracking"></a></h4>
   <p>A site wants to know which of its links a user clicks on.</p>
   <h3 class="heading settled" data-level="6.2" id="goals-tracking"><span class="secno">6.2. </span><span class="content">Tracking</span><a class="self-link" href="#goals-tracking"></a></h3>
   <p><a data-link-type="biblio" href="#biblio-tracking-dnt">[tracking-dnt]</a> defines "tracking" as the collection of data regarding a
particular user’s activity across multiple distinct contexts and the retention,
use, or sharing of data derived from that activity outside the context in which
it occurred. A context is a set of resources that are controlled by the same
party or jointly controlled by a set of parties. The following are building
blocks that allow a tracker to build such a log of a user’s activity.</p>
   <h4 class="heading settled" data-level="6.2.1" id="goal-transfer-userid"><span class="secno">6.2.1. </span><span class="content">Transfer user ID from publisher 1 to publisher 2 on navigation.</span><a class="self-link" href="#goal-transfer-userid"></a></h4>
   <p>When the user clicks a link from <a data-link-type="dfn" href="#publisher" id="ref-for-publisher">publisher</a> 1 that navigates to <a data-link-type="dfn" href="#publisher" id="ref-for-publisher①">publisher</a> 2, publisher 2’s server learns that a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id③">user ID</a> on publisher 2 and a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id④">user ID</a> on
publisher 1 represent the same <a data-link-type="dfn" href="#user" id="ref-for-user③">user</a>.</p>
   <h4 class="heading settled" data-level="6.2.2" id="goal-userid-tracker-to-self-in-pub"><span class="secno">6.2.2. </span><span class="content">Transfer user ID from tracker to that tracker running within a publisher, on navigation.</span><a class="self-link" href="#goal-userid-tracker-to-self-in-pub"></a></h4>
   <p>When the user clicks a link from <code>tracker.example</code> to <code>publisher.example</code>, that <a data-link-type="dfn" href="#tracker" id="ref-for-tracker">tracker’s</a> server learns that a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id⑤">user ID</a> for either <code>publisher.example</code> or
the tracker running within <code>publisher.example</code> and a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id⑥">user ID</a> for <code>tracker.example</code> represent the same <a data-link-type="dfn" href="#user" id="ref-for-user④">user</a>.</p>
   <h4 class="heading settled" data-level="6.2.3" id="goal-userid-tracker-in-pub1-to-self-in-pub2"><span class="secno">6.2.3. </span><span class="content">Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</span><a class="self-link" href="#goal-userid-tracker-in-pub1-to-self-in-pub2"></a></h4>
   <p>When the user clicks a link from <code>publisher1.example</code> (where a tracker was
embedded within that site) to <code>publisher2.example</code> (which has the same tracker
embedded), that <a data-link-type="dfn" href="#tracker" id="ref-for-tracker①">tracker’s</a> server learns that a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id⑦">user ID</a> for either <code>publisher1.example</code> or the tracker running within <code>publisher1.example</code> and a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id⑧">user ID</a> for either <code>publisher2.example</code> or the tracker running within <code>publisher2.example</code> represent the same <a data-link-type="dfn" href="#user" id="ref-for-user⑤">user</a>.</p>
   <h4 class="heading settled" data-level="6.2.4" id="goal-prob-transfer-userid"><span class="secno">6.2.4. </span><span class="content">Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</span><a class="self-link" href="#goal-prob-transfer-userid"></a></h4>
   <p>When the user clicks a link from <a data-link-type="dfn" href="#publisher" id="ref-for-publisher②">publisher</a> 1 that navigates to <a data-link-type="dfn" href="#publisher" id="ref-for-publisher③">publisher</a> 2, publisher 2’s server learns that a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id⑨">user ID</a> on publisher 2 and a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id①⓪">user ID</a> on
publisher 1 are more likely than chance to represent the same <a data-link-type="dfn" href="#user" id="ref-for-user⑥">user</a>.</p>
   <h4 class="heading settled" data-level="6.2.5" id="goal-prob-transfer-userid-no-nav"><span class="secno">6.2.5. </span><span class="content">Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</span><a class="self-link" href="#goal-prob-transfer-userid-no-nav"></a></h4>
   <p>While the user is visiting <a data-link-type="dfn" href="#publisher" id="ref-for-publisher④">publisher</a> 1, that publisher can tell <a data-link-type="dfn" href="#publisher" id="ref-for-publisher⑤">publisher</a> 2 that a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id①①">user ID</a> on publisher 2 and a <a data-link-type="dfn" href="#user-id" id="ref-for-user-id①②">user ID</a> on publisher
1 are more likely than chance to represent the same <a data-link-type="dfn" href="#user" id="ref-for-user⑦">user</a>, without requiring
the user to navigate from publisher 1 to publisher 2.</p>
   <h2 class="heading settled" data-level="7" id="essential"><span class="secno">7. </span><span class="content">Essential Web APIs</span><a class="self-link" href="#essential"></a></h2>
   <p>These are Web APIs and features that would destroy the Web as we know it if they
went away. The placement of some features here will be contentious, and those
features are marked as I discover the contention.</p>
   <h3 class="heading settled" data-level="7.1" id="ess-js-requests"><span class="secno">7.1. </span><span class="content">Javascript can make requests to servers</span><a class="self-link" href="#ess-js-requests"></a></h3>
   <p>This could perhaps be broken down into same-origin requests and cross-origin
requests, with cross-origin requests being more contentious.</p>
   <h3 class="heading settled" data-level="7.2" id="ess-server-defined-paths"><span class="secno">7.2. </span><span class="content">Servers can define the paths under which they host content</span><a class="self-link" href="#ess-server-defined-paths"></a></h3>
   <p>These paths can include opaque strings that neither a human nor a user agent can
interpret without knowing how the server works, like <code>/t/proposal-packaging-for-the-web-signed-and-indexed/1827/10</code> and <code>/Moby-Dick-Herman-Melville/dp/1503280780/</code>.</p>
   <h2 class="heading settled" data-level="8" id="acknowledgements"><span class="secno">8. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
   <p>As far as I know, Safari did the first work to prove that a more
privacy-preserving web was possible, by blocking third-party cookies by default
and then shipping <a href="https://webkit.org/blog/7675/intelligent-tracking-prevention/">ITP
1.0</a>, without
breaking the world. They eventually published their <a href="https://webkit.org/tracking-prevention-policy/">policy for Tracking
Prevention</a>,
which heavily influenced this document.</p>
   <p>I believe Mozilla wrote the first concrete <a href="https://wiki.mozilla.org/Security/Anti_tracking_policy">anti-tracking
policy</a>, which inspired
Safari’s policy.</p>
   <p>Michael Kleber on the Chrome team proposed a <a href="https://github.com/michaelkleber/privacy-model">Privacy Model for the
Web</a>, which suggests blocking
the transfer of <a data-link-type="dfn" href="#user-id" id="ref-for-user-id①③">user IDs</a> between top-level sites and suggests a few ways
that information could flow between sites without compromising user privacy.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#attacker">attacker</a><span>, in §2</span>
   <li><a href="#first-party">first party</a><span>, in §2</span>
   <li><a href="#global-identifier">global identifier</a><span>, in §2</span>
   <li><a href="#party">party</a><span>, in §2</span>
   <li><a href="#publisher">publisher</a><span>, in §2</span>
   <li><a href="#site">site</a><span>, in §2</span>
   <li><a href="#third-party">third party</a><span>, in §2</span>
   <li><a href="#tracker">tracker</a><span>, in §2</span>
   <li><a href="#user">user</a><span>, in §2</span>
   <li><a href="#user-id">user ID</a><span>, in §2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-concept-origin">
   <a href="https://html.spec.whatwg.org/multipage/origin.html#concept-origin">https://html.spec.whatwg.org/multipage/origin.html#concept-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-origin">2. Terminology</a> <a href="#ref-for-concept-origin①">(2)</a> <a href="#ref-for-concept-origin②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-top-level-browsing-context">
   <a href="https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context">https://html.spec.whatwg.org/multipage/browsers.html#top-level-browsing-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-top-level-browsing-context">2. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-format">
   <a href="https://publicsuffix.org/list/#list-format">https://publicsuffix.org/list/#list-format</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-format">2. Terminology</a> <a href="#ref-for-list-format①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-section-4.1.2.6">
   <a href="https://tools.ietf.org/html/rfc6265#section-4.1.2.6">https://tools.ietf.org/html/rfc6265#section-4.1.2.6</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-section-4.1.2.6">5.2. Run Javascript in a first-party context</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-concept-origin" style="color:initial">origin</span>
     <li><span class="dfn-paneled" id="term-for-top-level-browsing-context" style="color:initial">top-level browsing context</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PSL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-format" style="color:initial">registrable domain</span>
    </ul>
   <li>
    <a data-link-type="biblio">[rfc6265]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-section-4.1.2.6" style="color:initial">httponly</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-psl">[PSL]
   <dd><cite><a href="https://publicsuffix.org/">Public Suffix List</a></cite>.    Mozilla Foundation.
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc6265">[RFC6265]
   <dd>A. Barth. <a href="https://httpwg.org/specs/rfc6265.html">HTTP State Management Mechanism</a>. April 2011. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc6265.html">https://httpwg.org/specs/rfc6265.html</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-psl-problems">[PSL-PROBLEMS]
   <dd>Ryan Sleevi. <a href="https://github.com/sleevi/psl-problems">Public Suffix List Problems</a>. URL: <a href="https://github.com/sleevi/psl-problems">https://github.com/sleevi/psl-problems</a>
   <dt id="biblio-tracking-dnt">[TRACKING-DNT]
   <dd>Roy Fielding; David Singer. <a href="https://www.w3.org/TR/tracking-dnt/">Tracking Preference Expression (DNT)</a>. 17 January 2019. NOTE. URL: <a href="https://www.w3.org/TR/tracking-dnt/">https://www.w3.org/TR/tracking-dnt/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This section is not complete. It lists a lot of potential privacy
threats, but needs editing to pick which kinds of threats belong in this threat
model and to unify the multiple lists of suggestions.<a href="#issue-05a52c93"> ↵ </a></div>
   <div class="issue"> Should we mark goals attackers can currently achieve, which we want to
remove, differently from goals attackers already can’t achieve?<a href="#issue-eb037c92"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="site">
   <b><a href="#site">#site</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-site">2. Terminology</a> <a href="#ref-for-site①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="party">
   <b><a href="#party">#party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-party">2. Terminology</a> <a href="#ref-for-party①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="first-party">
   <b><a href="#first-party">#first-party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-first-party">2. Terminology</a> <a href="#ref-for-first-party①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="third-party">
   <b><a href="#third-party">#third-party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-third-party">2. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user">
   <b><a href="#user">#user</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user">2. Terminology</a> <a href="#ref-for-user①">(2)</a> <a href="#ref-for-user②">(3)</a>
    <li><a href="#ref-for-user③">6.2.1. Transfer user ID from publisher 1 to publisher 2 on navigation.</a>
    <li><a href="#ref-for-user④">6.2.2. Transfer user ID from tracker to that tracker running within a publisher, on navigation.</a>
    <li><a href="#ref-for-user⑤">6.2.3. Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</a>
    <li><a href="#ref-for-user⑥">6.2.4. Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</a>
    <li><a href="#ref-for-user⑦">6.2.5. Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user-id">
   <b><a href="#user-id">#user-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-id">2. Terminology</a>
    <li><a href="#ref-for-user-id①">4.1. Anti-tracking</a>
    <li><a href="#ref-for-user-id②">5.3. Modify server processing</a>
    <li><a href="#ref-for-user-id③">6.2.1. Transfer user ID from publisher 1 to publisher 2 on navigation.</a> <a href="#ref-for-user-id④">(2)</a>
    <li><a href="#ref-for-user-id⑤">6.2.2. Transfer user ID from tracker to that tracker running within a publisher, on navigation.</a> <a href="#ref-for-user-id⑥">(2)</a>
    <li><a href="#ref-for-user-id⑦">6.2.3. Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</a> <a href="#ref-for-user-id⑧">(2)</a>
    <li><a href="#ref-for-user-id⑨">6.2.4. Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</a> <a href="#ref-for-user-id①⓪">(2)</a>
    <li><a href="#ref-for-user-id①①">6.2.5. Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</a> <a href="#ref-for-user-id①②">(2)</a>
    <li><a href="#ref-for-user-id①③">8. Acknowledgements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="global-identifier">
   <b><a href="#global-identifier">#global-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-global-identifier">2. Terminology</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attacker">
   <b><a href="#attacker">#attacker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attacker">6. Attacker goals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="publisher">
   <b><a href="#publisher">#publisher</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-publisher">6.2.1. Transfer user ID from publisher 1 to publisher 2 on navigation.</a> <a href="#ref-for-publisher①">(2)</a>
    <li><a href="#ref-for-publisher②">6.2.4. Probabilistically transfer user ID from publisher 1 to publisher 2 on navigation.</a> <a href="#ref-for-publisher③">(2)</a>
    <li><a href="#ref-for-publisher④">6.2.5. Probabilistically transfer user ID from publisher 1 to publisher 2 without navigation.</a> <a href="#ref-for-publisher⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="tracker">
   <b><a href="#tracker">#tracker</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-tracker">6.2.2. Transfer user ID from tracker to that tracker running within a publisher, on navigation.</a>
    <li><a href="#ref-for-tracker①">6.2.3. Transfer user ID from tracker within publisher 1 to that tracker within publisher 2, on navigation.</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>